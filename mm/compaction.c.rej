diff a/mm/compaction.c b/mm/compaction.c	(rejected hunks)
@@ -677,7 +677,7 @@ unsigned long try_to_compact_pages(struct zonelist *zonelist,
 
 
 /* Compact all zones within a node */
-static int compact_node(int nid)
+static int compact_node(int nid, bool sync)
 {
 	int zoneid;
 	pg_data_t *pgdat;
@@ -695,6 +695,7 @@ static int compact_node(int nid)
 			.nr_freepages = 0,
 			.nr_migratepages = 0,
 			.order = -1,
+            .sync = sync,
 		};
 
 		zone = &pgdat->node_zones[zoneid];
@@ -715,12 +716,12 @@ static int compact_node(int nid)
 }
 
 /* Compact all nodes in the system */
-int compact_nodes(void)
+int compact_nodes(bool sync)
 {
 	int nid;
 
 	for_each_online_node(nid)
-		compact_node(nid);
+		compact_node(nid, sync);
 
 	return COMPACT_COMPLETE;
 }
@@ -733,7 +734,7 @@ int sysctl_compaction_handler(struct ctl_table *table, int write,
 			void __user *buffer, size_t *length, loff_t *ppos)
 {
 	if (write)
-		return compact_nodes();
+		return compact_nodes(true);
 
 	return 0;
 }
